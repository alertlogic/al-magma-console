<div class="system-logs">
    <!-- Next step and description -->
    <div fxLayout="row" class="under-line">
        <div fxFlex="70">
            <h1 i18n>System Logs</h1>
        </div>
        <div fxFlex="30" fxLayoutAlign="end" fxFlexFill="0">
            <button color="primary" mat-raised-button (click)="next()">NEXT</button>
        </div>
    </div>

    <!-- Nav Tools -->
    <al-header-nav-tool
        #headerNavTool
        [config]="headerNavToolConf"
        (onOpenedForm)="onOpenedForm($event)"
        (onSearched)="onSearch($event)">
    </al-header-nav-tool>

    <al-content-toolbar #headerNavTool
            [config]="toolbarConfig"
            (onGroupSelection)="filter($event)">
    </al-content-toolbar>

    <div class="p-grid p-align-center">
        <p-dropdown class="p-col-10 p-sm-10 p-md-6 p-lg-4 p-xl-3"
            [options]="sortConfig.options"
            (onChange)="handleSortSelection($event)">
        </p-dropdown>
        <i  class="p-col-1" class="content-toolbar-sort-direction material-icons al-sort"
            (click)="handleSortDirection()" [pTooltip]="sortConfig.order === 'ASC' ?  'ascending' : 'descending'">
            swap_vert
        </i>
    </div>

    <!-- Zero State -->
    <al-view-helper [loading]="loading && !apiError"
        [empty]="filteredCards.length === 0 && !loading && !apiError">
        <i class="al al-application-set" zero-state-icon></i>
        <span zero-state-description i18n>
            No results.
        </span>
    </al-view-helper>

    <!-- Error State -->
    <al-view-helper [empty]="apiError">
        <i class="material-icons" zero-state-icon>
            info
        </i>
        <span zero-state-description i18n>
            Requested source is not available at this moment
        </span>
    </al-view-helper>

    <!-- List -->
    <ng-container *ngFor="let card of filteredCards">
        <al-system-log-card *ngIf="!loading" [card]="card"
                            (onAction)="cardAction($event)"
                            (onCollect)="cardCollectChange($event)"
                            (onExpand)="expand($event)">
        </al-system-log-card>
    </ng-container>

    <!-- Confirmation dialog -->
    <p-confirmDialog #confirmationDelete [header]="deleteConfirmartionHeaderTitle" [style]="{width: '50vw'}">
        <p-footer>
            <button type="button" pButton label="Cancel" (click)="confirmationDelete.reject()"></button>
            <button type="button" pButton class="primaryAction" label="Delete" (click)="confirmationDelete.accept()"></button>
        </p-footer>
    </p-confirmDialog>

    <al-deployment-system-logs-create-rule-form *ngIf="showModalForm"
        [typeRule]="typeRule"
        [accountId]="accountId"
        [action]="action"
        [ruleId]="ruleId"
        [rulePayload]="rulePayload"
        [headerOptions]="headerOptions"
        [isDefaultRule]="isDefaultRule"
        [deploymentId]="deploymentId"
        (saveModal)="onSaveModal($event)"
        (closeModal)="onCloseModal($event)">
    </al-deployment-system-logs-create-rule-form>

    <!-- Add scope rules modal form -->
    <al-deployment-application-logs-add-scope-rule-form
        #addRuleForm
        [accountId]="deployment.account_id"
        [deploymentId]="deployment.id"
        [onlyTagAssets]="false"
        [assetsMap]="assetsMap"
        [allowedAssetTypes]="allowedAssetTypes"
        [headerOptions]="addRuleFormHeaderOptions"
        (saveModal)="afterSubmitAssetsForm($event, 'add_rule')">
    </al-deployment-application-logs-add-scope-rule-form>

    <al-toast key="notifications"></al-toast>
</div>

