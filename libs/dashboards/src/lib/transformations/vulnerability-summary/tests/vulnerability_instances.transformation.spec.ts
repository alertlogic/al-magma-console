import { vulnerabilityInstances} from '../vulnerability_instances.transformation';
import { ExposuresSummary } from '@al/assets-query';

describe('Transformation Test Suite: Vulnerability Instances', () => {
  describe('Given an exposures summary response object', () => {
    it('should return the "all" value ', () => {
      const response: ExposuresSummary = {
        summary: {
          all: 11,
          high: 1,
          medium: 3,
          low: 7,
          info: 0
        },
        exposures:[]
      };
      expect(vulnerabilityInstances([response])).toEqual({primaryCount: 11});
    });
  });
  describe('Given a response object containing to summary', () => {
    it('should return a zero value" value ', () => {
      const response = {
        exposures:[]
      };
      expect(vulnerabilityInstances([response])).toEqual({primaryCount: 0});
    });
  });
});
