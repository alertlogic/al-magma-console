import * as Transformation from '../most_vulnerable_hosts.transformation';
import { Widget as WidgetConfig, TableListConfig, ZeroStateReason } from '@al/ng-visualizations-components';

describe('Top ten most vulnerable hosts', () => {

  describe('when there are no results', () => {
    it('should return a zero state reason for no results', () => {
      const response = {
        rows: [],
      };

      const config = Transformation.mostVulnerableHosts(response);
      expect(config).toEqual({
        nodata: true,
        reason: ZeroStateReason.Zero
      });
    });
  });
  describe('when there are results', () => {
    it('should return a list of the most vulnerable hosts', () => {
        const response = {
          rows: [
            ["Default Datacenter Deployment","10.10.128.3",40,3]
          ]
        };

      const config = Transformation.mostVulnerableHosts(response);
      expect(config).toEqual({
        headers: [
          {name: 'Host Name', field: 'host_name', class: 'left'},
          {name: 'Count', field: 'count', class: 'right'},
          {name: 'Deployment', field: 'deployment_name', class: 'left'},
          {name: 'Worst Severity', field: 'status', class: 'left status'}
        ],
        body: [{
          host_name: '10.10.128.3',
          count: 40,
          deployment_name: 'Default Datacenter Deployment',
          status: 'high'
        }]
      });
    });
  });
});
