

/**
 * vulnerabilityInstancesBI transformation
 * kalm: dashboards_deployment_vulnerabilities
 * @param response - raw data from API
 */
export const vulnerabilityInstancesBI = (response: { rows: any[][], column_info: { type: string, name: string } }) => {
  enum Column {
    AccountId,
    DeploymentId,
    DeploymentName,
    Severity,
    VulnerabilityCount
  }
  if (response.rows.length === 0) return { primaryCount: 0 };
  const reducer = (accumulator, currentValue) => accumulator + currentValue;
  return {
    primaryCount: response.rows.map(item => item[Column.VulnerabilityCount]).reduce(reducer)
  };
};

