import { malwareAttacksDetected} from '../malware-attacks-detected.transformation';
import { SummaryResponse, endpointResponse } from '../../tests/mocks/endpoint.mocks';

describe('Transformation Test Suite: Malware Attacks Detected', () => {
  it('should return 1 when total incidents is 1', () => {
    const response: SummaryResponse = Object.assign({},
      endpointResponse, {
      summary: {
        totalIncidents: 1
      }
    });
    expect(malwareAttacksDetected(response)).toEqual({primaryCount: 1});
  });

  it('should return 0 when total incidents is undefined', () => {
    const response: SummaryResponse = Object.assign({},
      endpointResponse, {
      summary: {
        totalIncidents: undefined
      }
    });
    expect(malwareAttacksDetected(response)).toEqual({primaryCount: 0});
  });
});
