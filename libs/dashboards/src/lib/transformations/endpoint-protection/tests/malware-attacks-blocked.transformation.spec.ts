import { malwareAttacksBlocked } from '../malware-attacks-blocked.transformation';
import { SummaryResponse, endpointResponse } from '../../tests/mocks/endpoint.mocks';

describe('Transformation Test Suite: Malware Attacks Blocked', () => {
  it('should return 1 when total protect incidents is 1', () => {
    const response: SummaryResponse = Object.assign({},
      endpointResponse, {
      summary: {
        totalProtectIncidents: 1
      }
    });
    expect(malwareAttacksBlocked(response)).toEqual({primaryCount: 1});
  });

  it('should return 0 when total protect incidents is undefined', () => {
    const response: SummaryResponse = Object.assign({},
      endpointResponse, {
      summary: {
        totalProtectIncidents: undefined
      }
    });
    expect(malwareAttacksBlocked(response)).toEqual({primaryCount: 0});
  });
});
